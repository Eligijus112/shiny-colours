"0","pp <- cbind(as.vector(unlist(photo[ , , 1])), as.vector(unlist(photo[ , , 2])), as.vector(unlist(photo[ , , 3]))) %>% as.data.frame"
"0","names(pp) <- c(""R"", ""G"", ""B"")"
"0","set.seed(10)"
"0","kk <- kmeans(pp, centers=10)"
"0","pp$cluster <- kk$cluster "
"0","pp <- ddply(pp, ~cluster, function(xframe){"
"0","        "
"0","        xframe <<- xframe"
"0","        "
"0","        xframe$mean.R <- mean(xframe$R)"
"0","        xframe$mean.G <- mean(xframe$G)"
"0","        xframe$mean.B <- mean(xframe$B)"
"0","        "
"0","        xframe$col.name <- rgb(mean(xframe$R), mean(xframe$G), mean(xframe$B))"
"0","        "
"0","        return(xframe)"
"0","        "
"0","})"
"0","      "
"0","pp <- arrange(pp, cluster)"
"0","describtive.data <- ddply(pp, ~ cluster, function(xframe) {"
"0","  xframe <<- xframe"
"0","  "
"0","  xframe$length <- dim(xframe)[1]"
"0","  "
"0","  return(xframe[nrow(xframe), c(""col.name"", ""length"")])"
"0","  "
"0","})"
"0","      "
"0","describtive.data <- arrange(describtive.data, length)"
"0","par(mai=c(1,2,1,1))"
"0","barplot( describtive.data$length,"
"0","col = describtive.data$col.name,"
"0","names.arg = describtive.data$col.name,"
"0","horiz = T, las = 1, xaxt = 'n', main = ""Decomposition of colours"")"
